{"ast":null,"code":"/**\r\n * DevExtreme (core/utils/dom.js)\r\n * Version: 19.2.7\r\n * Build date: Thu Mar 26 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../../core/renderer\");\n\nvar config = require(\"../../core/config\");\n\nvar domAdapter = require(\"../../core/dom_adapter\");\n\nvar windowUtils = require(\"./window\");\n\nvar window = windowUtils.getWindow();\n\nvar eventsEngine = require(\"../../events/core/events_engine\");\n\nvar inArray = require(\"./array\").inArray;\n\nvar typeUtils = require(\"./type\");\n\nvar isDefined = typeUtils.isDefined;\nvar isRenderer = typeUtils.isRenderer;\n\nvar htmlParser = require(\"../../core/utils/html_parser\");\n\nvar elementStrategy;\n\nvar resetActiveElement = function () {\n  var activeElement = domAdapter.getActiveElement();\n  var body = domAdapter.getBody();\n\n  if (activeElement && activeElement !== body && activeElement.blur) {\n    try {\n      activeElement.blur();\n    } catch (e) {\n      body.blur();\n    }\n  }\n};\n\nvar clearSelection = function () {\n  var selection = window.getSelection();\n\n  if (!selection) {\n    return;\n  }\n\n  if (\"Caret\" === selection.type) {\n    return;\n  }\n\n  if (selection.empty) {\n    selection.empty();\n  } else {\n    if (selection.removeAllRanges) {\n      try {\n        selection.removeAllRanges();\n      } catch (e) {}\n    }\n  }\n};\n\nvar closestCommonParent = function (startTarget, endTarget) {\n  var $startTarget = $(startTarget);\n  var $endTarget = $(endTarget);\n\n  if ($startTarget[0] === $endTarget[0]) {\n    return $startTarget[0];\n  }\n\n  var $startParents = $startTarget.parents();\n  var $endParents = $endTarget.parents();\n  var startingParent = Math.min($startParents.length, $endParents.length);\n\n  for (var i = -startingParent; i < 0; i++) {\n    if ($startParents.get(i) === $endParents.get(i)) {\n      return $startParents.get(i);\n    }\n  }\n};\n\nvar triggerVisibilityChangeEvent = function (eventName) {\n  var VISIBILITY_CHANGE_SELECTOR = \".dx-visibility-change-handler\";\n  return function (element) {\n    var $element = $(element || \"body\");\n    var changeHandlers = $element.filter(VISIBILITY_CHANGE_SELECTOR).add($element.find(VISIBILITY_CHANGE_SELECTOR));\n\n    for (var i = 0; i < changeHandlers.length; i++) {\n      eventsEngine.triggerHandler(changeHandlers[i], eventName);\n    }\n  };\n};\n\nvar uniqueId = function () {\n  var counter = 0;\n  return function (prefix) {\n    return (prefix || \"\") + counter++;\n  };\n}();\n\nvar dataOptionsAttributeName = \"data-options\";\n\nvar getElementOptions = function (element) {\n  var optionsString = $(element).attr(dataOptionsAttributeName) || \"\";\n  return config().optionsParser(optionsString);\n};\n\nvar createComponents = function (elements, componentTypes) {\n  var result = [];\n  var selector = \"[\" + dataOptionsAttributeName + \"]\";\n  var $items = elements.find(selector).add(elements.filter(selector));\n  $items.each(function (index, element) {\n    var $element = $(element);\n    var options = getElementOptions(element);\n\n    for (var componentName in options) {\n      if (!componentTypes || inArray(componentName, componentTypes) > -1) {\n        if ($element[componentName]) {\n          $element[componentName](options[componentName]);\n          result.push($element[componentName](\"instance\"));\n        }\n      }\n    }\n  });\n  return result;\n};\n\nvar createMarkupFromString = function (str) {\n  if (!window.WinJS) {\n    return $(htmlParser.parseHTML(str));\n  }\n\n  var tempElement = $(\"<div>\");\n  window.WinJS.Utilities.setInnerHTMLUnsafe(tempElement.get(0), str);\n  return tempElement.contents();\n};\n\nvar extractTemplateMarkup = function (element) {\n  element = $(element);\n  var templateTag = element.length && element.filter(function () {\n    var $node = $(this);\n    return $node.is(\"script[type]\") && $node.attr(\"type\").indexOf(\"script\") < 0;\n  });\n\n  if (templateTag.length) {\n    return templateTag.eq(0).html();\n  } else {\n    element = $(\"<div>\").append(element);\n    return element.html();\n  }\n};\n\nvar normalizeTemplateElement = function normalizeTemplateElement(element) {\n  var $element = isDefined(element) && (element.nodeType || isRenderer(element)) ? $(element) : $(\"<div>\").html(element).contents();\n\n  if (1 === $element.length) {\n    if ($element.is(\"script\")) {\n      $element = normalizeTemplateElement($element.html().trim());\n    } else {\n      if ($element.is(\"table\")) {\n        $element = $element.children(\"tbody\").contents();\n      }\n    }\n  }\n\n  return $element;\n};\n\nvar clipboardText = function (event, text) {\n  var clipboard = event.originalEvent && event.originalEvent.clipboardData || window.clipboardData;\n\n  if (1 === arguments.length) {\n    return clipboard && clipboard.getData(\"Text\");\n  }\n\n  clipboard && clipboard.setData(\"Text\", text);\n};\n\nvar contains = function (container, element) {\n  if (!element) {\n    return false;\n  }\n\n  element = domAdapter.isTextNode(element) ? element.parentNode : element;\n  return domAdapter.isDocument(container) ? container.documentElement.contains(element) : container.contains(element);\n};\n\nvar getPublicElement = function ($element) {\n  return elementStrategy($element);\n};\n\nvar setPublicElementWrapper = function (value) {\n  elementStrategy = value;\n};\n\nsetPublicElementWrapper(function (element) {\n  return element && element.get(0);\n});\n\nvar createTextElementHiddenCopy = function (element, text, options) {\n  var elementStyles = window.getComputedStyle($(element).get(0));\n  var includePaddings = options && options.includePaddings;\n  return $(\"<div>\").text(text).css({\n    fontStyle: elementStyles.fontStyle,\n    fontVariant: elementStyles.fontVariant,\n    fontWeight: elementStyles.fontWeight,\n    fontSize: elementStyles.fontSize,\n    fontFamily: elementStyles.fontFamily,\n    letterSpacing: elementStyles.letterSpacing,\n    border: elementStyles.border,\n    paddingTop: includePaddings ? elementStyles.paddingTop : \"\",\n    paddingRight: includePaddings ? elementStyles.paddingRight : \"\",\n    paddingBottom: includePaddings ? elementStyles.paddingBottom : \"\",\n    paddingLeft: includePaddings ? elementStyles.paddingLeft : \"\",\n    visibility: \"hidden\",\n    whiteSpace: \"nowrap\",\n    position: \"absolute\",\n    \"float\": \"left\"\n  });\n};\n\nexports.setPublicElementWrapper = setPublicElementWrapper;\nexports.resetActiveElement = resetActiveElement;\nexports.createMarkupFromString = createMarkupFromString;\nexports.triggerShownEvent = triggerVisibilityChangeEvent(\"dxshown\");\nexports.triggerHidingEvent = triggerVisibilityChangeEvent(\"dxhiding\");\nexports.triggerResizeEvent = triggerVisibilityChangeEvent(\"dxresize\");\nexports.getElementOptions = getElementOptions;\nexports.createComponents = createComponents;\nexports.extractTemplateMarkup = extractTemplateMarkup;\nexports.normalizeTemplateElement = normalizeTemplateElement;\nexports.clearSelection = clearSelection;\nexports.uniqueId = uniqueId;\nexports.closestCommonParent = closestCommonParent;\nexports.clipboardText = clipboardText;\nexports.contains = contains;\nexports.getPublicElement = getPublicElement;\nexports.createTextElementHiddenCopy = createTextElementHiddenCopy;","map":null,"metadata":{},"sourceType":"script"}