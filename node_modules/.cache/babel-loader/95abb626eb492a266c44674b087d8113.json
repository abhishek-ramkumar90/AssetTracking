{"ast":null,"code":"/**\r\n * DevExtreme (localization/intl/number.js)\r\n * Version: 19.2.7\r\n * Build date: Thu Mar 26 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _config = require(\"../../core/config\");\n\nvar _config2 = _interopRequireDefault(_config);\n\nvar _core = require(\"../core\");\n\nvar _version = require(\"../../core/version\");\n\nvar _version2 = _interopRequireDefault(_version);\n\nvar _version3 = require(\"../../core/utils/version\");\n\nvar _open_xml_currency_format = require(\"../open_xml_currency_format\");\n\nvar _open_xml_currency_format2 = _interopRequireDefault(_open_xml_currency_format);\n\nvar _accounting_formats = require(\"../cldr-data/accounting_formats\");\n\nvar _accounting_formats2 = _interopRequireDefault(_accounting_formats);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar detectCurrencySymbolRegex = /([^\\s0]+)?(\\s*)0*[.,]*0*(\\s*)([^\\s0]+)?/;\nvar formattersCache = {};\n\nvar getFormatter = function (format) {\n  var key = (0, _core.locale)() + \"/\" + JSON.stringify(format);\n\n  if (!formattersCache[key]) {\n    formattersCache[key] = new Intl.NumberFormat((0, _core.locale)(), format).format;\n  }\n\n  return formattersCache[key];\n};\n\nvar getCurrencyFormatter = function (currency) {\n  return new Intl.NumberFormat((0, _core.locale)(), {\n    style: \"currency\",\n    currency: currency\n  });\n};\n\nmodule.exports = {\n  engine: function () {\n    return \"intl\";\n  },\n  _formatNumberCore: function (value, format, formatConfig) {\n    if (\"exponential\" === format) {\n      return this.callBase.apply(this, arguments);\n    }\n\n    return getFormatter(this._normalizeFormatConfig(format, formatConfig))(value);\n  },\n  _normalizeFormatConfig: function (format, formatConfig, value) {\n    var config;\n\n    if (\"decimal\" === format) {\n      config = {\n        minimumIntegerDigits: formatConfig.precision || void 0,\n        useGrouping: false,\n        maximumFractionDigits: String(value).length,\n        round: value < 0 ? \"ceil\" : \"floor\"\n      };\n    } else {\n      config = this._getPrecisionConfig(formatConfig.precision);\n    }\n\n    if (\"percent\" === format) {\n      config.style = \"percent\";\n    } else {\n      if (\"currency\" === format) {\n        config.style = \"currency\";\n        config.currency = formatConfig.currency || (0, _config2.default)().defaultCurrency;\n      }\n    }\n\n    return config;\n  },\n  _getPrecisionConfig: function (precision) {\n    var config;\n\n    if (null === precision) {\n      config = {\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 20\n      };\n    } else {\n      config = {\n        minimumFractionDigits: precision || 0,\n        maximumFractionDigits: precision || 0\n      };\n    }\n\n    return config;\n  },\n  format: function (value, _format) {\n    if (\"number\" !== typeof value) {\n      return value;\n    }\n\n    _format = this._normalizeFormat(_format);\n\n    if (\"default\" === _format.currency) {\n      _format.currency = (0, _config2.default)().defaultCurrency;\n    }\n\n    if (!_format || \"function\" !== typeof _format && !_format.type && !_format.formatter) {\n      return getFormatter(_format)(value);\n    }\n\n    return this.callBase.apply(this, arguments);\n  },\n  parse: function (text, format) {\n    if ((0, _version3.compare)(_version2.default, \"17.2.8\") >= 0) {\n      return this.callBase.apply(this, arguments);\n    }\n\n    if (!text) {\n      return;\n    }\n\n    if (format && format.parser) {\n      return format.parser(text);\n    }\n\n    text = this._normalizeNumber(text, format);\n\n    if (text.length > 15) {\n      return NaN;\n    }\n\n    return parseFloat(text);\n  },\n  _normalizeNumber: function (text, format) {\n    var isExponentialRegexp = /^[-+]?[0-9]*.?[0-9]+([eE][-+]?[0-9]+)+$/;\n    var legitDecimalSeparator = \".\";\n\n    if (this.convertDigits) {\n      text = this.convertDigits(text, true);\n    }\n\n    if (isExponentialRegexp.test(text)) {\n      return text;\n    }\n\n    var decimalSeparator = this._getDecimalSeparator(format);\n\n    var cleanUpRegexp = new RegExp(\"[^0-9-\\\\\" + decimalSeparator + \"]\", \"g\");\n    return text.replace(cleanUpRegexp, \"\").replace(decimalSeparator, legitDecimalSeparator);\n  },\n  _getDecimalSeparator: function (format) {\n    return getFormatter(format)(.1)[1];\n  },\n  _getCurrencySymbolInfo: function (currency) {\n    var formatter = getCurrencyFormatter(currency);\n    return this._extractCurrencySymbolInfo(formatter.format(0));\n  },\n  _extractCurrencySymbolInfo: function (currencyValueString) {\n    var match = detectCurrencySymbolRegex.exec(currencyValueString) || [];\n    var position = match[1] ? \"before\" : \"after\";\n    var symbol = match[1] || match[4] || \"\";\n    var delimiter = match[2] || match[3] || \"\";\n    return {\n      position: position,\n      symbol: symbol,\n      delimiter: delimiter\n    };\n  },\n  getCurrencySymbol: function (currency) {\n    if (!currency) {\n      currency = (0, _config2.default)().defaultCurrency;\n    }\n\n    var symbolInfo = this._getCurrencySymbolInfo(currency);\n\n    return {\n      symbol: symbolInfo.symbol\n    };\n  },\n  getOpenXmlCurrencyFormat: function (currency) {\n    var targetCurrency = currency || (0, _config2.default)().defaultCurrency;\n\n    var currencySymbol = this._getCurrencySymbolInfo(targetCurrency).symbol;\n\n    var closestAccountingFormat = (0, _core.getValueByClosestLocale)(function (locale) {\n      return _accounting_formats2.default[locale];\n    });\n    return (0, _open_xml_currency_format2.default)(currencySymbol, closestAccountingFormat);\n  }\n};","map":null,"metadata":{},"sourceType":"script"}