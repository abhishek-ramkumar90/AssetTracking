{"ast":null,"code":"/**\r\n * DevExtreme (events/pointer/mouse_and_touch.js)\r\n * Version: 19.2.7\r\n * Build date: Thu Mar 26 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar extend = require(\"../../core/utils/extend\").extend;\n\nvar BaseStrategy = require(\"./base\");\n\nvar MouseStrategy = require(\"./mouse\");\n\nvar TouchStrategy = require(\"./touch\");\n\nvar eventUtils = require(\"../utils\");\n\nvar eventMap = {\n  dxpointerdown: \"touchstart mousedown\",\n  dxpointermove: \"touchmove mousemove\",\n  dxpointerup: \"touchend mouseup\",\n  dxpointercancel: \"touchcancel\",\n  dxpointerover: \"mouseover\",\n  dxpointerout: \"mouseout\",\n  dxpointerenter: \"mouseenter\",\n  dxpointerleave: \"mouseleave\"\n};\nvar activated = false;\n\nvar activateStrategy = function () {\n  if (activated) {\n    return;\n  }\n\n  MouseStrategy.activate();\n  activated = true;\n};\n\nvar MouseAndTouchStrategy = BaseStrategy.inherit({\n  EVENT_LOCK_TIMEOUT: 100,\n  ctor: function () {\n    this.callBase.apply(this, arguments);\n    activateStrategy();\n  },\n  _handler: function (e) {\n    var isMouseEvent = eventUtils.isMouseEvent(e);\n\n    if (!isMouseEvent) {\n      this._skipNextEvents = true;\n    }\n\n    if (isMouseEvent && this._mouseLocked) {\n      return;\n    }\n\n    if (isMouseEvent && this._skipNextEvents) {\n      this._skipNextEvents = false;\n      this._mouseLocked = true;\n      clearTimeout(this._unlockMouseTimer);\n      var that = this;\n      this._unlockMouseTimer = setTimeout(function () {\n        that._mouseLocked = false;\n      }, this.EVENT_LOCK_TIMEOUT);\n      return;\n    }\n\n    return this.callBase(e);\n  },\n  _fireEvent: function (args) {\n    var isMouseEvent = eventUtils.isMouseEvent(args.originalEvent);\n    var normalizer = isMouseEvent ? MouseStrategy.normalize : TouchStrategy.normalize;\n    return this.callBase(extend(normalizer(args.originalEvent), args));\n  },\n  dispose: function () {\n    this.callBase();\n    this._skipNextEvents = false;\n    this._mouseLocked = false;\n    clearTimeout(this._unlockMouseTimer);\n  }\n});\nMouseAndTouchStrategy.map = eventMap;\nMouseAndTouchStrategy.resetObserver = MouseStrategy.resetObserver;\nmodule.exports = MouseAndTouchStrategy;","map":null,"metadata":{},"sourceType":"script"}